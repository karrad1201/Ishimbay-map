{% extends "base.html" %}

{% block title %}Редактирование улицы {{ street.name }}{% endblock %}
{% block header %}Редактирование улицы {{ street.name }}{% endblock %}

{% block content %}
    <h2>Редактирование улицы</h2>

    <div class="pages-container">
        {% for page in street.pages %}
        <!-- Страница {{ loop.index }} -->
        <div class="page" id="page-{{ loop.index }}" {% if loop.index > 1 %}style="display: none;"{% endif %}>
            <div class="object-editor-content">
                <div class="scrollable-content">
                    <form method="post" action="/admin/edit" id="object-form-{{ loop.index }}">
                        <input type="hidden" name="street_id" value="{{ street.id }}">

                        <label for="page-{{ loop.index }}-title">Заголовок:</label>
                        <input type="text" id="page-{{ loop.index }}-title" name="page-{{ loop.index }}-title" value="{{ page.title }}"><br><br>

                        <label for="page-{{ loop.index }}-content">Содержание:</label>
                        <textarea id="page-{{ loop.index }}-content" name="page-{{ loop.index }}-content" class="description-textarea">{{ page.content }}</textarea><br><br>

                        <label for="page-{{ loop.index }}-photo">Фото:</label>
                        <input type="text" id="page-{{ loop.index }}-photo" name="page-{{ loop.index }}-photo" value="{{ page.photo }}"><br><br>

                        {% if loop.index == 1 %}
                            <label for="name">Название:</label>
                            <input type="text" id="name" name="name" value="{{ street.name }}"><br><br>

                            <label for="city">Город:</label>
                            <input type="text" id="city" name="city" value="{{ street.city }}"><br><br>

                            <label for="class">Класс:</label>
                            <input type="text" id="class" name="class" value="{{ street.class }}"><br><br>

                            <label for="lat">Широта:</label>
                            <input type="text" id="lat" name="lat" value="{{ street.lat }}"><br><br>

                            <label for="lon">Долгота:</label>
                            <input type="text" id="lon" name="lon" value="{{ street.lon }}"><br><br>

                            <label for="nominatimQuery">Nominatim Query:</label>
                            <input type="text" id="nominatimQuery" name="nominatimQuery" value="{{ street.nominatimQuery }}"><br><br>

                            <label for="panorama">Панорама:</label>
                            <input type="text" id="panorama" name="panorama" value="{{ street.panorama }}"><br><br>

                            <label for="type">Тип:</label>
                            <input type="text" id="type" name="type" value="{{ street.type }}"><br><br>
                        {% endif %}
                    </form>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="pagination-container">
        <div class="pagination">
            <div class="page-numbers">
                {% for page in street.pages %}
                <span class="page-number {% if loop.index == 1 %}active{% endif %}" data-page="{{ loop.index }}" href="#" role="button">{{ loop.index }}</span>
                {% endfor %}
            </div>
            <button id="add-page-button" class="add-page-button">
                <i class="fas fa-plus"></i>
            </button>
        </div>
    </div>

    <div class="button-container">
        <button type="submit" class="save-button" form="object-form-1">
            <i class="fas fa-save"></i> Сохранить
        </button>

        <form method="post" action="/admin/delete_street" onsubmit="return confirm('Вы уверены, что хотите удалить эту улицу?');">
            <input type="hidden" name="street_id" value="{{ street.id }}">
            <button id="delete-object-button" class="delete-button" type="submit">
                <i class="fas fa-trash-alt"></i>
                <span>Удалить улицу</span>
            </button>
        </form>
        
        {% for page in street.pages %}
            {% if loop.index > 1 %}
                <form method="post" action="/admin/delete_page" onsubmit="return confirm('Вы уверены, что хотите удалить эту страницу?');">
                    <input type="hidden" name="street_id" value="{{ street.id }}">
                    <input type="hidden" name="page_index" value="{{ loop.index }}">
                    <button class="delete-button" type="submit">Удалить страницу</button>
                </form>
            {% endif %}
        {% endfor %}
    </div>
{% endblock %}
